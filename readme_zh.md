# multi-label learning dataset and data-loader

这个代码仓库可以帮你

1. 将来自 [Multi-Label Classification Dataset Repository](https://www.uco.es/kdis/mllresources/) 的数据集的 arff 格式统一
2. 在 `.arff` and `.mat` (for matlab) 格式之间进行转换

## 如何使用

安装所需的包

```
$ pip install -r requirements.txt
```

扫描当前目录下的数据集并打印它们的基本信息

```bash
$ python dataset.py
```

通过一个简单的脚本将  `.arff` 格式的数据集转为 `.mat` 格式

```bash
$ python arff2mat.py
```

## 使用前请阅读

由于 `.arff` 格式并不区分特征和标签，
我们需要手动将 $n \times (m+q)$ 矩阵分割成数据部分 (X) 和标签部分 (y). 
然而, 来自 Mulan 的数据集文件倾向于将标签部分放在特征部分前面 ( $n \times (q+m)$ ), 
而来自 Meka 的数据集文件倾向于将标签部分放在特征部分后面 ( $n \times (m+q)$ ). 
这种偏好上的差异无法由程序自动区分，除非我们添加必要的元信息。

因此，你需要**手动**将这些元信息加入到 `.arff` 文件中，
以便于代码正确且自动地读取特征和标签. 


## 如何添加元信息

像这样的一个 `.arff` 文件 (`ENRON.arff`) 

```
@relation Enron

@attribute A.A8 {0,1}
@attribute C.C9 {0,1}
@attribute B.B12 {0,1}
@attribute C.C11 {0,1}
@attribute C.C5 {0,1}
@attribute C.C7 {0,1}
...
@attribute 0 numeric
@attribute 00 numeric
@attribute 000 numeric

@data

{14 1,40 1,46 1,49 1,193 1,441 1,841 1}
{12 1,14 1,37 1,39 1,49 1,56 1,69 1,71 1,76 1,117 1,118 1,133 1,136 1,141 1,209 1,239 1,240 1,242 1,245 1,252 1,255 1,302 1,304 1,316 1,331 1,344 1,364 1,411 1,451 1,458 1,473 1,479 1,528 1,535 1,551 1,556 1,581 1,608 1,613 1,662 1,683 1,705 1,741 1,758 1,763 1,764 1,796 1,835 1,857 1,869 1,872 1,901 1,928 1,939 1,964 1,982 1,1000 1,1012 1,1043 1}
{11 1,242 1,247 1,442 1,561 1,862 1}
{11 1,199 1,386 1,558 1,583 1,590 1}
{11 1,199 1,237 1,265 1,312 1,381 1,394 1,398 1,412 1,458 1,483 1,490 1,494 1,532 1,560 1,626 1,655 1,708 1,729 1,734 1,855 1,968 1,979 1,993 1,1008 1,1050 1}
...
```

请像这样修改文件头部的 **`@relation` 行**

```
@relation 'Enron: -n 1702 -m 1001 -q 53 -label_location start -is_sparse true'

@attribute A.A8 {0,1}
@attribute C.C9 {0,1}
@attribute B.B12 {0,1}
@attribute C.C11 {0,1}
@attribute C.C5 {0,1}
@attribute C.C7 {0,1}
...
@attribute 0 numeric
@attribute 00 numeric
@attribute 000 numeric

@data

{14 1,40 1,46 1,49 1,193 1,441 1,841 1}
{12 1,14 1,37 1,39 1,49 1,56 1,69 1,71 1,76 1,117 1,118 1,133 1,136 1,141 1,209 1,239 1,240 1,242 1,245 1,252 1,255 1,302 1,304 1,316 1,331 1,344 1,364 1,411 1,451 1,458 1,473 1,479 1,528 1,535 1,551 1,556 1,581 1,608 1,613 1,662 1,683 1,705 1,741 1,758 1,763 1,764 1,796 1,835 1,857 1,869 1,872 1,901 1,928 1,939 1,964 1,982 1,1000 1,1012 1,1043 1}
{11 1,242 1,247 1,442 1,561 1,862 1}
{11 1,199 1,386 1,558 1,583 1,590 1}
{11 1,199 1,237 1,265 1,312 1,381 1,394 1,398 1,412 1,458 1,483 1,490 1,494 1,532 1,560 1,626 1,655 1,708 1,729 1,734 1,855 1,968 1,979 1,993 1,1008 1,1050 1}
``` 

下面是这些参数的详细解释: 

1. `-n`: 样本数量 (未被实际使用)
2. `-m`: 特征的维度数 (未被实际使用)
3. `-q`: 标签的维度数
4. `-label_location`: 如果 `@attribute` 先列出特征的 attribute, 填 `start`; 否则填 `end`
5. `-is_sparse`: 如果 `@data` 以稀疏格式存储, 填 `true`; 否则填 `false` (未被实际使用)

如此照做后，你就可以自动读取数据集了! 
祝你使用愉快 :)
